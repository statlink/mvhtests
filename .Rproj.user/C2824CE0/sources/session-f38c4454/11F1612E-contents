\name{Multivariate analysis of variance assuming equality of the covariance matrices}
\alias{maov}
\title{
Multivariate analysis of variance assuming equality of the covariance matrices
}

\description{
Multivariate analysis of variance assuming equality of the covariance matrices.
}

\usage{
maov(x, ina)
}

\arguments{
\item{x}{
A matrix containing Euclidean data.
}
\item{ina}{
A numerical or factor variable indicating the groups of the data.
}
}

\details{
The extension of the Hotelling's T$^2$ test for two samples to three or more samples is called MANOVA (Multivariate Analysis of Variance). There is a built-in function as I mentioned before, but it's not very easy to use. Therefore I programmed my own function for this purpose.

Suppose we have $n$ observations in total from \eqn{g} distinct \eqn{p}-variate normal populations with means \eqn{\pmb{\mu}_i} and covariance matrices \eqn{\pmb{\Sigma}_i} and we want to test whether \eqn{\pmb{\mu}_1 = \pmb{\mu}_2 = \ldots = \pmb{\mu}_g}, when assuming that \eqn{\pmb{\Sigma}_1 = \pmb{\Sigma}_2 = \ldots = \pmb{\Sigma}_g} holds true. This is the multivariate generalization of the (univariate) analysis of variance, and thus the M letter in the front.
We need the within and the between sum of squares only
\deqn{
{\bf W} = \sum_{i=1}^g\left(n_i-1\right){\bf \Sigma}_i
}
and
\deqn{
{\bf B} = \sum_{i=1}^gn_i\left(\bar{{\bf X}}_i-\bar{{\bf X}}\right)\left(\bar{{\bf X}}_i-\bar{{\bf X}}\right)^T
}
respectively, where \eqn{\bar{{\bf X}}} is the mean vector of all samples together.

Wilks's \eqn{\Lambda} is defined as (Johnson and Wichern, 2007)
\deqn{
\Lambda = \frac{\vert{\bf W} \vert}{\vert{\bf W} +{\bf B}\vert} = \frac{1}{\vert{\bf I}_p +{\bf W}^{-1}{\bf B}\vert}.
}

Johnson and Wichern (2007, pg. 303) mention that
\deqn{
\frac{n-p-1}{p}\frac{1-\Lambda}{\Lambda} \sim F_{p,n-p-1} if g=2
}
and
\deqn{
\frac{n-p-2}{p}\frac{1-\sqrt{\Lambda}}{\sqrt{\Lambda}} \sim F_{2p,2\left(n-p-2\right)} if g=3.
}
As for the other cases I found a paper by Todorov and Filzmoser (2010) who mention that a popular approximation to Wilk's \eqn{\Lambda} is Bartlett's \eqn{\chi^2} approximation given by \eqn{-\left[n-1-\left(p+g\right)/2 \right]\log{\Lambda} \sim \chi^2_{p\left(g-1\right)}}.

In the function a message will appear mentioning which approximation has been used, the \eqn{F} or the \eqn{\chi^2}.
}

\value{
A list including:
\item{note}{
A message stating whether the \eqn{F} or the \eqn{chi^2} approximation has been used.
}
\item{result}{
The test statistic and the p-value.
}
}

\references{
Johnson and Wichern (2007, 6th Edition). Applied Multivariate Statistical Analysis p. 302--303.

Todorov V. and Filzmoser P. (2010). Robust Statistic for the One-way MANOVA.
Computational Statistics & Data Analysis 54(1):37--48.
}

\author{
Michail Tsagris.

R implementation and documentation: Michail Tsagris \email{mtsagris@uoc.gr}.
}

%\note{
%%  ~~further notes~~
%}

\seealso{
\code{\link{maovjames}, \link{hotel2T2}, \link{james}
}
}

\examples{
maov( as.matrix(iris[,1:4]), iris[,5] )
maovjames( as.matrix(iris[,1:4]), iris[,5] )
}

